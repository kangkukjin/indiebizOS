# IndieBiz OS 상세 설명서 (Full Specification)

## 1. 개요 (Overview)
IndieBiz OS는 개인과 소규모 비즈니스를 위한 AI 기반 통합 관리 시스템입니다. 사용자가 프로젝트 단위로 목표를 설정하고, 다양한 전문성을 가진 AI 에이전트 팀을 구성하여 업무를 자동화하고 효율화할 수 있도록 돕습니다.

### 핵심 가치
- **나만의 AI 인격 설계**: 단순히 역할 부여를 넘어 말투, 태도, 지식 맥락을 가진 페르소나를 직접 정의.
- **원클릭 자동화 (스위치)**: 반복적인 작업을 자연어 프롬프트로 정의하고 클릭 한 번으로 실행.
- **데이터 주권 및 P2P 네트워크**: 사용자의 데이터는 로컬에 저장되며, Nostr 프로토콜을 통해 탈중앙화된 통신 지원.

## 2. 시스템 아키텍처 (Architecture)
IndieBiz OS는 Python FastAPI 백엔드와 Electron + React 프론트엔드로 구성된 데스크톱 애플리케이션입니다.

### 핵심 컴포넌트
- **AIAgent Core**: 시스템 AI와 프로젝트 에이전트가 동일한 `AIAgent` 클래스를 공유하여 일관된 행동과 도구 사용 로직을 보장합니다.
- **프롬프트 빌더**: XML 태그 구조를 활용하여 AI의 파싱 정확도를 높이고, 조건부 프래그먼트를 통해 상황에 맞는 지침을 동적으로 주입합니다.
- **통합 프로바이더**: Anthropic Claude, OpenAI GPT, Google Gemini, Ollama(로컬 LLM) 등 다양한 모델을 스트리밍 방식으로 지원합니다.

## 3. 주요 기능 (Key Features)

### 프로젝트 및 에이전트 시스템
- **격리된 작업공간**: 각 프로젝트는 독립적인 대화 기록, 에이전트 설정, 맥락을 보유합니다.
- **위임 체인 (Delegation Chain)**: 에이전트 간에 작업을 비동기적으로 위임하고 결과를 자동으로 보고받는 협업 시스템입니다.
- **시스템 AI 위임**: 메타 컨트롤러인 시스템 AI가 각 프로젝트의 전문 에이전트에게 작업을 배포할 수 있습니다.

### 자동화 및 스케줄링
- **스위치 (Switches)**: 자주 사용하는 프롬프트를 버튼 형태로 저장하여 즉시 실행.
- **스케줄러**: Cron 표현식을 사용하여 특정 시간에 스위치를 자동 실행 (예: 매일 오전 8시 뉴스 요약).

### 비즈니스 관리 및 자동응답
- **통신 채널**: Gmail(OAuth2) 및 Nostr(P2P)을 통한 외부 메시지 송수신.
- **자동응답 V3**: AI가 도구를 직접 사용하여 판단, 비즈니스 DB 검색, 응답 발송을 한 번에 처리하는 지능형 시스템.

### 도구 패키지 시스템
- **동적 로딩**: 에이전트별로 필요한 도구만 로드하여 효율성 극대화.
- **패키지 공유**: Nostr 네트워크를 통해 사용자가 만든 도구 패키지를 공개하거나 다른 사용자의 패키지를 검색 및 설치 가능.

## 4. 기술적 세부사항 (Technical Details)

### 데이터베이스 구조
- **SQLite 기반**: `business.db`(비즈니스/메시지), `multi_chat.db`(채팅방), 프로젝트별 `conversations.db` 사용.
- **상태 관리**: 태스크(Task) 단위로 위임 상태와 컨텍스트를 관리하여 스테이트리스(Stateless) 에이전트 간의 연속성 유지.

### 보안 및 프라이버시
- **로컬 우선**: 모든 주요 데이터와 설정은 사용자 로컬 디렉토리에 저장.
- **검열 저항**: Nostr 프로토콜을 사용하여 중앙 서버 없는 독립적인 비즈니스 네트워크 구축.

## 5. 설치 및 실행 (Setup)
- **백엔드**: Python 3.10+, FastAPI, venv 환경 권장.
- **프론트엔드**: Node.js 18+, Electron 빌드 지원.
- **실행**: `./start.sh` 스크립트를 통해 백엔드와 프론트엔드 동시 실행 가능.

---
*마지막 업데이트: 2026-01-26*
