"""
법원경매 사이트 가이드
=====================
대한민국 법원 경매정보 (courtauction.go.kr)에서
경매 물건 정보를 수집하기 위한 가이드.
"""


SITE_CONFIG = {
    "id": "courtauction",
    "name": "대한민국 법원 경매정보",
    "url": "https://www.courtauction.go.kr",
    "description": "대한민국 법원 경매정보 공식 사이트. 부동산/동산 경매 물건 검색, 감정가/최저가 확인, 매각기일 조회.",

    "key_field": "case_no",
    "fields": {
        "case_no": {"type": "text", "label": "사건번호"},
        "item_no": {"type": "text", "label": "물건번호"},
        "court": {"type": "text", "label": "담당법원"},
        "location": {"type": "text", "label": "소재지"},
        "usage": {"type": "text", "label": "용도"},
        "area": {"type": "text", "label": "면적"},
        "appraisal_price": {"type": "text", "label": "감정가"},
        "minimum_price": {"type": "text", "label": "최저매각가"},
        "status": {"type": "text", "label": "진행상태"},
        "auction_date": {"type": "text", "label": "매각기일"},
        "bid_count": {"type": "text", "label": "유찰횟수"}
    },

    "search_params": {
        "region": {"type": "text", "label": "지역 (예: 충북, 서울, 경기)"},
        "usage_type": {"type": "text", "label": "용도 (예: 아파트, 토지, 상가)"}
    },

    "guide": """
## 검색 방법

### 빠른검색 (권장)
1. https://www.courtauction.go.kr 접속
2. 메인 페이지 상단에 '물건검색' 메뉴가 있음
3. '빠른검색' 선택 → 주소 입력란이 나옴
4. 소재지(주소) 입력란에 검색어 입력 (예: "오송", "강남", "세종")
5. '검색' 버튼 클릭
6. 결과 테이블이 아래에 표시됨

### 상세검색
1. '물건검색' → '상세검색' 선택
2. 시/도 드롭다운에서 지역 선택 (서울특별시, 충청북도 등)
3. 용도 선택 가능 (아파트, 토지, 상가 등)
4. 매각기일 범위 설정 가능
5. '검색' 클릭

### 주의사항
- 이 사이트는 WebSquare 프레임워크 사용 → 일반 HTML과 다를 수 있음
- 검색 결과가 1000건 초과 시 팝업이 뜰 수 있음 → 팝업 닫기 후 결과 확인
- 페이지 로딩이 느릴 수 있으므로 검색 후 충분히 대기

## 결과 추출

### 결과 테이블 열 구조
빠른검색/상세검색 모두 결과가 테이블 형태로 표시됨.
browser_get_content로 테이블 텍스트를 추출하거나,
browser_snapshot으로 테이블의 각 셀을 읽을 수 있음.

주요 열:
- 사건번호 (예: 2025타경12345)
- 물건번호 (예: 1, 2)
- 소재지 (주소)
- 용도 (아파트, 토지, 상가 등)
- 감정가 (원 단위 금액)
- 최저매각가 (원 단위 금액)
- 매각기일 (YYYY.MM.DD 형식)
- 진행상태 (진행중, 매각, 유찰 등)

### 상세 페이지
테이블에서 사건번호를 클릭하면 상세 페이지로 이동.
상세 페이지에서 추가 정보 확인 가능:
- 면적, 층수, 건축년도
- 유찰 이력, 감정평가서
- 임차인 정보, 권리분석

## 데이터 저장 (wc_save 호출 시)

### key_field: case_no
- 사건번호가 고유 키 (예: "2025타경12345")
- 같은 사건번호의 데이터는 업데이트됨 (새로 추가되지 않음)
- 물건번호가 여러 개인 경우 case_no에 물건번호를 붙여 구분
  (예: "2025타경12345-1", "2025타경12345-2")

### 필드 정규화
- appraisal_price, minimum_price: 숫자만 추출 (쉼표, "원", "만" 등 제거)
  예: "1,500,000,000원" → "1500000000"
- auction_date: YYYY.MM.DD 또는 YYYY-MM-DD 형식
- case_no: 공백 제거, "타경" 앞에 연도 포함 확인

## 데이터 해석

### 핵심 지표
- **최저가율**: minimum_price / appraisal_price × 100
  - 80% = 1회 유찰 (20% 감가)
  - 64% = 2회 유찰
  - 51% = 3회 유찰
  - 41% = 4회 유찰
  - 비율이 낮을수록 여러 번 유찰 → 저가 매수 기회일 수 있음

### 상태 해석
- "진행중" = 아직 매각 전, 입찰 가능
- "매각" = 이미 낙찰됨 (과거 데이터)
- "유찰" = 입찰자 없음, 다음 기일에 감가 재매각
- "취하" = 채권자가 경매 취소
- "변경" = 매각기일이 변경됨

### 사용자 보고 시 강조할 필드
1. 소재지 (location) - 어디에 있는 물건인지
2. 용도 (usage) - 아파트/토지/상가 등
3. 감정가 vs 최저가 - 할인율
4. 매각기일 - 언제 입찰할 수 있는지
5. 상태 - 현재 진행 상황

### 데이터 유효기간
- 매각기일이 지난 "진행중" 물건은 이미 결과가 나왔을 수 있음
- 정기적으로 재수집하여 상태 변화 추적 권장
- DB에 축적하면 유찰 추세, 가격 변동 분석 가능
"""
}
